# ES5 和 ES6 的主要区别

ES5 (ECMAScript 5) 和 ES6 (ECMAScript 2015) 是 JavaScript 语言的两个重要版本，ES6 是 JavaScript 的一次重大更新。以下是它们之间的主要区别：

## 1. 变量声明

**ES5**:
- 只有 `var` 声明变量
- 没有块级作用域，只有函数作用域
- 容易产生变量提升和全局污染问题

**ES6**:
- 新增 `let` 和 `const` 声明变量
- `let` 有块级作用域
- `const` 声明常量，不可重新赋值
- 解决了变量提升问题

```javascript
// ES5
var x = 10
if (true) {
  var x = 20 // 同一个变量
}

// ES6
let y = 10
if (true) {
  let y = 20 // 不同的变量
}
const PI = 3.14 // 常量
```

## 2. 箭头函数

**ES5**:
- 传统函数表达式
- `this` 指向取决于调用方式

**ES6**:
- 新增箭头函数 `=>`
- 更简洁的语法
- `this` 继承自外层作用域(词法作用域)

```javascript
// ES5
var add = function(a, b) {
  return a + b;
};

// ES6
const add = (a, b) => a + b;

// this 指向示例
function Timer() {
  this.seconds = 0;
  // ES5
  setInterval(function() {
    this.seconds++; // 这里的this指向window
  }, 1000);
  // ES6
  setInterval(() => {
    this.seconds++; // 这里的this指向Timer实例
  }, 1000);
}
```

## 3. 类(Class)

**ES5**:
- 使用构造函数和原型链模拟类
- 语法较为繁琐

**ES6**:
- 新增 `class` 关键字
- 更接近传统面向对象语言的语法
- 本质仍是基于原型的继承

```javascript
// ES5
function Person(name) {
  this.name = name;
}
Person.prototype.sayHello = function() {
  console.log('Hello, ' + this.name);
};

// ES6
class Person {
  constructor(name) {
    this.name = name;
  }
  sayHello() {
    console.log(`Hello, ${this.name}`);
  }
}
```

## 4. 模块化

**ES5**:
- 没有原生的模块系统
- 依赖 CommonJS (Node.js) 或 AMD (浏览器) 等模块化方案

**ES6**:
- 新增原生模块系统
- 使用 `import` 和 `export` 语法

```javascript
// ES5 (CommonJS)
var moduleA = require('./moduleA');
module.exports = { ... };

// ES6
import moduleA from './moduleA';
export default { ... };
export const foo = 'bar';
```

## 5. 解构赋值

**ES5**:
- 需要手动逐个赋值

**ES6**:
- 新增解构赋值语法
- 可以从数组或对象中提取值赋给变量

```javascript
// ES5
var first = array[0];
var second = array[1];

// ES6
const [first, second] = array;

// 对象解构
const { name, age } = person;
```

## 6. 默认参数和剩余参数

**ES5**:
- 没有默认参数语法
- 剩余参数需要使用 `arguments` 对象

**ES6**:
- 新增默认参数
- 新增剩余参数语法 `...`

```javascript
// 默认参数
function greet(name = 'Guest') {
  console.log(`Hello, ${name}`)
}

// 剩余参数
function sum(...numbers) {
  return numbers.reduce((total, num) => total + num, 0)
}
```

## 7. 扩展运算符

**ES5**:
- 数组/对象合并需要手动操作

**ES6**:
- 新增扩展运算符 `...`
- 可以轻松展开数组或对象

```javascript
// 数组合并
const arr1 = [1, 2]
const arr2 = [3, 4]
const combined = [...arr1, ...arr2]

// 对象合并
const obj1 = { a: 1 }
const obj2 = { b: 2 }
const merged = { ...obj1, ...obj2 }
```

## 8. 模板字符串

**ES5**:
- 字符串拼接需要使用 `+` 运算符

**ES6**:
- 新增模板字符串
- 使用反引号 `` ` `` 包裹
- 支持多行字符串和变量插值

```javascript
// ES5
var name = 'Alice';
var greeting = 'Hello, ' + name + '!';

// ES6
const name = 'Alice';
const greeting = `Hello, ${name}!
This is a multi-line string.`;
```

## 9. 对象字面量增强

**ES5**:
- 对象属性和方法需要显式定义

**ES6**:
- 属性简写
- 方法简写
- 可以在对象字面量中使用变量作为属性名

```javascript
// ES5
var name = 'Alice';
var obj = {
  name: name,
  sayHello: function() {
    console.log('Hello');
  }
};

// ES6
const name = 'Alice';
const obj = {
  name, // 属性简写
  sayHello() { // 方法简写
    console.log('Hello');
  }
};
```

## 10. Promise 和异步编程

**ES5**:
- 异步编程主要依赖回调函数
- 容易产生"回调地狱"

**ES6**:
- 新增 `Promise` 对象
- 提供更优雅的异步编程方式
- 为后来的 `async/await` 奠定基础

```javascript
// ES5 回调地狱
fs.readFile('file1.txt', (err, data1) => {
  if (err)
    throw err
  fs.readFile('file2.txt', (err, data2) => {
    if (err)
      throw err
    // ...
  })
})

// ES6 Promise
readFile('file1.txt')
  .then(data1 => readFile('file2.txt'))
  .then((data2) => { /* ... */ })
  .catch(err => console.error(err))
```

## 11. 其他重要新增特性

1. **Symbol**:
   - 新增原始数据类型 Symbol
   - 表示独一无二的值

2. **Set 和 Map**:
   - 新增集合(Set)和映射(Map)数据结构

3. **Proxy 和 Reflect**:
   - 提供元编程能力
   - 可以拦截和自定义对象的基本操作

4. **二进制和八进制字面量**:
   - 新增二进制(`0b`)和八进制(`0o`)字面量表示法

5. **Array 和 Object 的新方法**:
   - 如 `Array.from()`, `Array.find()`, `Object.assign()` 等

## 总结对比表

| 特性 | ES5 | ES6 |
|------|-----|-----|
| 变量声明 | var | let, const |
| 函数 | function | 箭头函数 |
| 类 | 构造函数+原型 | class |
| 模块化 | CommonJS/AMD | import/export |
| 解构赋值 | 无 | 支持 |
| 默认参数 | 无 | 支持 |
| 扩展运算符 | 无 | ... |
| 模板字符串 | +拼接 | `` ` `` |
| 对象字面量 | 传统 | 增强 |
| Promise | 无 | 支持 |
| Symbol | 无 | 新增 |
| Set/Map | 无 | 新增 |
| Proxy/Reflect | 无 | 新增 |

ES6 的这些改进使 JavaScript 语言更加强大、简洁和现代化，大大提高了开发效率和代码质量。
